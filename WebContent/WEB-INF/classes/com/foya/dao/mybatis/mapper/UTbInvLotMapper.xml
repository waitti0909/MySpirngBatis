<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.foya.dao.mybatis.mapper.UTbInvLotMapper" >
  <resultMap id="BaseResultMap" type="com.foya.dao.mybatis.model.TbInvLot" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 17 10:07:10 CST 2014.
    -->
    <id column="lot_no" property="lot_no" jdbcType="BIGINT" />
    <result column="mat_no" property="mat_no" jdbcType="VARCHAR" />
    <result column="fa_no" property="fa_no" jdbcType="VARCHAR" />
    <result column="po_no" property="po_no" jdbcType="VARCHAR" />
    <result column="rcv_date" property="rcv_date" jdbcType="TIMESTAMP" />
    <result column="buying_qty" property="buying_qty" jdbcType="INTEGER" />
    <result column="setup_qty" property="setup_qty" jdbcType="INTEGER" />
    <result column="discard_qty" property="discard_qty" jdbcType="INTEGER" />
    <result column="std_qty" property="std_qty" jdbcType="INTEGER" />
    <result column="cr_user" property="cr_user" jdbcType="VARCHAR" />
    <result column="cr_time" property="cr_time" jdbcType="TIMESTAMP" />
    <result column="md_user" property="md_user" jdbcType="VARCHAR" />
    <result column="md_time" property="md_time" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <select id="selectLotByMatNo_Setup" resultMap="BaseResultMap" parameterType="com.foya.dao.mybatis.model.TbInvLot" >
		select *
		from TB_INV_LOT
		<where> 
		    std_qty>0          
            <if test="mat_no != null" >
        		And mat_no = #{mat_no,jdbcType=VARCHAR}
      		</if>
      		
        </where>
        order by fa_no
	</select>
	
	<select id="selectLotByMatNo_Unload" resultMap="BaseResultMap" parameterType="com.foya.dao.mybatis.model.TbInvLot" >
		select *
		from TB_INV_LOT
		<where>
		    (buying_qty>std_qty)          
            <if test="mat_no != null" >
        		And mat_no = #{mat_no,jdbcType=VARCHAR}
      		</if>
      		
        </where>
        order by fa_no desc
	</select>
	
  <update id="updateByMatNoAndFaNo_Setup" parameterType="com.foya.dao.mybatis.model.TbInvLot" >
   
    update TB_INV_LOT
    <set >
      <if test="mat_no != null" >
        mat_no = #{mat_no,jdbcType=VARCHAR},
      </if>
      <if test="fa_no != null" >
        fa_no = #{fa_no,jdbcType=VARCHAR},
      </if>
      <if test="po_no != null" >
        po_no = #{po_no,jdbcType=VARCHAR},
      </if>
      <if test="rcv_date != null" >
        rcv_date = #{rcv_date,jdbcType=TIMESTAMP},
      </if>
      <if test="buying_qty != null" >
        buying_qty = #{buying_qty,jdbcType=INTEGER},
      </if>
      <if test="setup_qty != null" >
        setup_qty = setup_qty+#{setup_qty,jdbcType=INTEGER},
      </if>
      <if test="discard_qty != null" >
        discard_qty = #{discard_qty,jdbcType=INTEGER},
      </if>
      <if test="std_qty != null" >
        std_qty = std_qty-#{std_qty,jdbcType=INTEGER},
      </if>
      <if test="cr_user != null" >
        cr_user = #{cr_user,jdbcType=VARCHAR},
      </if>
      <if test="cr_time != null" >
        cr_time = #{cr_time,jdbcType=TIMESTAMP},
      </if>
      <if test="md_user != null" >
        md_user = #{md_user,jdbcType=VARCHAR},
      </if>
      <if test="md_time != null" >
        md_time = #{md_time,jdbcType=TIMESTAMP},
      </if>
    </set>
    where 
    mat_no = #{mat_no,jdbcType=VARCHAR}
	And  fa_no=#{fa_no,jdbcType=VARCHAR}

  </update>
  
  <update id="updateByMatNoAndFaNo_Unload" parameterType="com.foya.dao.mybatis.model.TbInvLot" >
   
    update TB_INV_LOT
    <set >
      <if test="mat_no != null" >
        mat_no = #{mat_no,jdbcType=VARCHAR},
      </if>
      <if test="fa_no != null" >
        fa_no = #{fa_no,jdbcType=VARCHAR},
      </if>
      <if test="po_no != null" >
        po_no = #{po_no,jdbcType=VARCHAR},
      </if>
      <if test="rcv_date != null" >
        rcv_date = #{rcv_date,jdbcType=TIMESTAMP},
      </if>
      <if test="buying_qty != null" >
        buying_qty = #{buying_qty,jdbcType=INTEGER},
      </if>
      <if test="setup_qty != null" >
        setup_qty = #{setup_qty,jdbcType=INTEGER},
      </if>
      <if test="discard_qty != null" >
        discard_qty = #{discard_qty,jdbcType=INTEGER},
      </if>
      <if test="std_qty != null" >
        std_qty = std_qty+#{std_qty,jdbcType=INTEGER},
      </if>
      <if test="cr_user != null" >
        cr_user = #{cr_user,jdbcType=VARCHAR},
      </if>
      <if test="cr_time != null" >
        cr_time = #{cr_time,jdbcType=TIMESTAMP},
      </if>
      <if test="md_user != null" >
        md_user = #{md_user,jdbcType=VARCHAR},
      </if>
      <if test="md_time != null" >
        md_time = #{md_time,jdbcType=TIMESTAMP},
      </if>
    </set>
    where 
    mat_no = #{mat_no,jdbcType=VARCHAR}
	And  fa_no=#{fa_no,jdbcType=VARCHAR}

  </update>
  
</mapper>