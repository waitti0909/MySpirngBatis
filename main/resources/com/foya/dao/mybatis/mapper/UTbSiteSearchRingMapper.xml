<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.foya.dao.mybatis.mapper.UTbSiteSearchRingMapper" >
  <resultMap id="BaseResultMap" type="com.foya.noms.dto.st.SearchRingDTO" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 29 14:18:45 CST 2014.
    -->
    <id column="SR_ID" jdbcType="VARCHAR" property="SR_ID" />
    <result column="FEQ_ID" jdbcType="VARCHAR" property="FEQ_ID" />
    <result column="SR_CITY" jdbcType="VARCHAR" property="SR_CITY" />
    <result column="SR_AREA" jdbcType="VARCHAR" property="SR_AREA" />
    <result column="SR_LON" jdbcType="DECIMAL" property="SR_LON" />
    <result column="SR_LAT" jdbcType="DECIMAL" property="SR_LAT" />
    <result column="SR_COVER_RANGE" jdbcType="VARCHAR" property="SR_COVER_RANGE" />
    <result column="CR_USER" jdbcType="VARCHAR" property="CR_USER" />
    <result column="CR_TIME" jdbcType="TIMESTAMP" property="CR_TIME" />
    <result column="MD_USER" jdbcType="VARCHAR" property="MD_USER" />
    <result column="MD_TIME" jdbcType="TIMESTAMP" property="MD_TIME" />
    <result column="FEQ_NAME" jdbcType="VARCHAR" property="feqName" />
    
  </resultMap>
  
  <select id="selectSearchRingList" resultMap="BaseResultMap">
    select  r.SR_ID,r.SR_LON,r.SR_LAT,r.SR_COVER_RANGE,r.SR_CITY,r.SR_AREA, f.FEQ_NAME ,r.FEQ_ID
	from TB_SITE_SEARCH_RING r
	left outer join TB_COM_SITE_FEQ f on f.FEQ_ID = r.FEQ_ID
	<where>
		<if test="srId !=null and srId !=''">
			and SR_ID = #{srId}
		</if>
		<if test="lonBeing !=null and lonBeing !='' and lonEnd != null and lonEnd !=''">
			and SR_LON between #{lonBeing} and #{lonEnd}
		</if>
		<if test="latBeing !=null and latBeing !='' and latEnd != null and latEnd !=''">
			and SR_LAT between #{latBeing} and #{latEnd} 
		</if>
		<if test="coverRange !=null and coverRange !=''">
			and SR_COVER_RANGE like '%'+#{coverRange}+'%'
		</if>
		<if test="city !=null and city !=''">
			and SR_CITY = #{city}
		</if>
		<if test="area !=null and area !=''">
			and SR_AREA = #{area}
		</if>
		<if test="addFeqCondition ==null or addFeqCondition ==''">
			<if test="feqId !=null and feqId !=''">
			and r.FEQ_ID = #{feqId}
			</if>
		</if>
		<if test="addFeqCondition !=null and addFeqCondition !=''">
			<if test="feqId !=null and feqId !=''">
				and (r.FEQ_ID = #{feqId} or r.FEQ_ID = #{addFeqCondition})
			</if>
		</if>
	</where>
  </select>
  
</mapper>